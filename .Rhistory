airline <- acs %>%
group_by(Airline) %>%
summarise(count= n())
age <- acs %>%
group_by(Age) %>%
summarise(count= n())
gender <- acs %>%
group_by(Gender) %>%
summarise(count= n())
nationality <- acs %>%
group_by(Nationality) %>%
summarise(count= n())
trippurpose <- acs %>%
group_by(TripPurpose) %>%
summarise(count= n())
provinceresidence <- acs %>%
group_by(ProvinceResidence) %>%
summarise(count= n())
grouptravel <- acs %>%
group_by(GroupTravel) %>%
summarise(count= n())
destination <- acs %>%
group_by(Destination) %>%
summarise(count= n())
departuretime <- acs %>%
group_by(DepartureTime) %>%
summarise(count= n())
seatclass <- acs %>%
group_by(SeatClass) %>%
summarise(count= n())
modetrans <- acs %>%
group_by(ModeTransport) %>%
summarise(count= n())
occupation <- acs %>%
group_by(Occupation) %>%
summarise(count= n())
income <- acs %>%
group_by(Income) %>%
summarise(count= n())
grid.arrange(
airport %>%
ggplot(aes(x = Airport, y = count)) +
geom_bar(stat = 'identity'),
airline %>%
ggplot(aes(x = Airline, y = count)) +
geom_bar(stat = 'identity'),
gender %>%
ggplot(aes(x = Gender, y = count)) +
geom_bar(stat = 'identity'),
nationality %>%
ggplot(aes(x = Nationality, y = count)) +
geom_bar(stat = 'identity'),
trippurpose %>%
ggplot(aes(x = TripPurpose, y = count)) +
geom_bar(stat = 'identity'),
provinceresidence %>%
ggplot(aes(x = ProvinceResidence, y = count)) +
geom_bar(stat = 'identity'),
grouptravel %>%
ggplot(aes(x = GroupTravel, y = count)) +
geom_bar(stat = 'identity'),
destination %>%
ggplot(aes(x = Destination, y = count)) +
geom_bar(stat = 'identity'),
departuretime %>%
ggplot(aes(x = DepartureTime, y = count)) +
geom_bar(stat = 'identity'),
seatclass %>%
ggplot(aes(x = SeatClass, y = count)) +
geom_bar(stat = 'identity'),
modetrans %>%
ggplot(aes(x = ModeTransport, y = count)) +
geom_bar(stat = 'identity'),
occupation %>%
ggplot(aes(x = Occupation, y = count)) +
geom_bar(stat = 'identity'),
income %>%
ggplot(aes(x = Income, y = count)) +
geom_bar(stat = 'identity'),
ncol = 4
)
# Categorical Variables
grid.arrange(
acs %>%
ggplot(aes(Gender,fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(Nationality, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(TripPurpose, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(ProvinceResidence, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(GroupTravel,fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(Destination, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(DepartureTime, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(SeatClass, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(ModeTransport, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(Occupation, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(Income, fill = Airport)) +
geom_bar(position = "dodge"),
ncol = 3
)
# Clear environment of variables and functions
rm(list = ls(all = TRUE))
# Clear environmet of packages
if(is.null(sessionInfo()$otherPkgs) == FALSE)lapply(paste("package:", names(sessionInfo()$otherPkgs), sep=""), detach, character.only = TRUE, unload = TRUE)
library(tidyverse)
library(GGally)
library(ggplot2)
library(readxl)
library(kableExtra)
library(gridExtra)
library(outliers)
library(Hmisc)
library(here)
# Load data
## CSV file
acs <- read.csv('airport_choice_survey_modified.csv')
#traffic <- read.csv('traffic.csv')
#province <- read.csv('province.csv')
#price <- read.csv('price.csv')
## XLSX file
# acs <- read_excel("airport_choice_survey_EN_ver2.0_Capstone.xlsx", sheet = 'Data')
# traffic <- read_excel("Airport_Airline_data.xlsx", sheet = 1)
# province <- read_excel("Airport_Airline_data.xlsx", sheet = 3)
# price <- read_excel("Airport_Airline_data.xlsx", sheet = 2)
str(acs)
summary(acs)
# Remove ID column
acs <- select(acs, -1)
# Remove unwanted variables: FlightNo, FrequentFlightDestination, DepartureHr, DepartureMn, Mileage, MileageAireline
acs <- acs[ , -c(12, 14:16, 26,27) ]
# Convert data type
acs$Airport <- as.factor(acs$Airport)
acs$Airline <- as.factor(acs$Airline)
acs$Gender <- as.factor(acs$Gender)
acs$Nationality <-as.factor(acs$Nationality)
acs$TripPurpose <-as.factor(acs$TripPurpose)
acs$ProvinceResidence <-as.factor(acs$ProvinceResidence)
acs$GroupTravel <-as.factor(acs$GroupTravel)
acs$Destination <-as.factor(acs$Destination)
acs$DepartureTime <-as.factor(acs$DepartureTime)
acs$SeatClass <-as.factor(acs$SeatClass)
acs$ModeTransport <-as.factor(acs$ModeTransport)
acs$Occupation <-as.factor(acs$Occupation)
acs$Income <-as.factor(acs$Income)
# Impute Missing Value
# Replace numerical variables' NAs with mean
impute(acs$Age, mean)
impute(acs$TripDuration, mean)
impute(acs$FlyingCompanion, mean)
impute(acs$NoTripsLastYear, mean)
impute(acs$Airfare, mean)
impute(acs$NoTransport, mean)
impute(acs$AccessCost, mean)
impute(acs$AcessTime, mean)
# Replace categorical variables' NAs with median
impute(acs$Nationality, median)
impute(acs$TripPurpose, median)
impute(acs$ProvinceResidence, median)
impute(acs$Destination, median)
impute(acs$DepartureTime, median)
impute(acs$ModeTransport, median)
impute(acs$Occupation, median)
impute(acs$Income, median)
# Impute Missing Value
# Replace numerical variables' NAs with mean
impute(acs$Age, mean)
impute(acs$TripDuration, mean)
impute(acs$FlyingCompanion, mean)
impute(acs$NoTripsLastYear, mean)
impute(acs$Airfare, mean)
impute(acs$NoTransport, mean)
impute(acs$AccessCost, mean)
impute(acs$AcessTime, mean)
# Replace categorical variables' NAs with median
impute(acs$Gender, median)
impute(acs$GroupTravel, median)
impute(acs$SeatClass, median)
impute(acs$Nationality, median)
impute(acs$TripPurpose, median)
impute(acs$ProvinceResidence, median)
impute(acs$Destination, median)
impute(acs$DepartureTime, median)
impute(acs$ModeTransport, median)
impute(acs$Occupation, median)
impute(acs$Income, median)
# Outliers - numerical
outlier(acs$Age)
outlier(acs$TripDuration)
outlier(acs$FlyingCompanion)
outlier(acs$NoTripsLastYear)
outlier(acs$Airfare)
outlier(acs$NoTransport)
outlier(acs$AccessCost)
outlier(acs$AccessTime)
# Remove Outliers
acs <- acs %>%
filter(Age!=70, TripDuration!=730,FlyingCompanion!=34, NoTripsLastYear!=30,Airfare!=200,NoTransport!=3, AccessCost!=350000, AccessTime!=390)
# Clear environment of variables and functions
rm(list = ls(all = TRUE))
# Clear environmet of packages
if(is.null(sessionInfo()$otherPkgs) == FALSE)lapply(paste("package:", names(sessionInfo()$otherPkgs), sep=""), detach, character.only = TRUE, unload = TRUE)
library(tidyverse)
library(GGally)
library(ggplot2)
library(readxl)
library(kableExtra)
library(gridExtra)
library(outliers)
library(Hmisc)
library(here)
# Load data
## CSV file
acs <- read.csv('airport_choice_survey_modified.csv')
#traffic <- read.csv('traffic.csv')
#province <- read.csv('province.csv')
#price <- read.csv('price.csv')
## XLSX file
# acs <- read_excel("airport_choice_survey_EN_ver2.0_Capstone.xlsx", sheet = 'Data')
# traffic <- read_excel("Airport_Airline_data.xlsx", sheet = 1)
# province <- read_excel("Airport_Airline_data.xlsx", sheet = 3)
# price <- read_excel("Airport_Airline_data.xlsx", sheet = 2)
str(acs)
summary(acs)
# Remove ID column
acs <- select(acs, -1)
# Remove unwanted variables: FlightNo, FrequentFlightDestination, DepartureHr, DepartureMn, Mileage, MileageAireline
acs <- acs[ , -c(12, 14:16, 26,27) ]
# Convert data type
acs$Airport <- as.factor(acs$Airport)
acs$Airline <- as.factor(acs$Airline)
acs$Gender <- as.factor(acs$Gender)
acs$Nationality <-as.factor(acs$Nationality)
acs$TripPurpose <-as.factor(acs$TripPurpose)
acs$ProvinceResidence <-as.factor(acs$ProvinceResidence)
acs$GroupTravel <-as.factor(acs$GroupTravel)
acs$Destination <-as.factor(acs$Destination)
acs$DepartureTime <-as.factor(acs$DepartureTime)
acs$SeatClass <-as.factor(acs$SeatClass)
acs$ModeTransport <-as.factor(acs$ModeTransport)
acs$Occupation <-as.factor(acs$Occupation)
acs$Income <-as.factor(acs$Income)
# Impute Missing Value
# Replace numerical variables' NAs with mean
impute(acs$Age, mean)
impute(acs$TripDuration, mean)
impute(acs$FlyingCompanion, mean)
impute(acs$NoTripsLastYear, mean)
impute(acs$Airfare, mean)
impute(acs$NoTransport, mean)
impute(acs$AccessCost, mean)
impute(acs$AcessTime, mean)
# Replace categorical variables' NAs with median
impute(acs$Gender, median)
impute(acs$GroupTravel, median)
impute(acs$SeatClass, median)
impute(acs$Nationality, median)
impute(acs$TripPurpose, median)
impute(acs$ProvinceResidence, median)
impute(acs$Destination, median)
impute(acs$DepartureTime, median)
impute(acs$ModeTransport, median)
impute(acs$Occupation, median)
impute(acs$Income, median)
# Outliers - numerical
outlier(acs$Age)
outlier(acs$TripDuration)
outlier(acs$FlyingCompanion)
outlier(acs$NoTripsLastYear)
outlier(acs$Airfare)
outlier(acs$NoTransport)
outlier(acs$AccessCost)
outlier(acs$AccessTime)
# Remove Outliers
acs <- acs %>%
filter(Age!=70, TripDuration!=730,FlyingCompanion!=34, NoTripsLastYear!=30,Airfare!=200,NoTransport!=3, AccessCost!=350000, AccessTime!=390)
# Data Vis
## Categorical
airport <- acs %>%
group_by(Airport) %>%
summarise(count= n())
airline <- acs %>%
group_by(Airline) %>%
summarise(count= n())
age <- acs %>%
group_by(Age) %>%
summarise(count= n())
gender <- acs %>%
group_by(Gender) %>%
summarise(count= n())
nationality <- acs %>%
group_by(Nationality) %>%
summarise(count= n())
trippurpose <- acs %>%
group_by(TripPurpose) %>%
summarise(count= n())
provinceresidence <- acs %>%
group_by(ProvinceResidence) %>%
summarise(count= n())
grouptravel <- acs %>%
group_by(GroupTravel) %>%
summarise(count= n())
destination <- acs %>%
group_by(Destination) %>%
summarise(count= n())
departuretime <- acs %>%
group_by(DepartureTime) %>%
summarise(count= n())
seatclass <- acs %>%
group_by(SeatClass) %>%
summarise(count= n())
modetrans <- acs %>%
group_by(ModeTransport) %>%
summarise(count= n())
occupation <- acs %>%
group_by(Occupation) %>%
summarise(count= n())
income <- acs %>%
group_by(Income) %>%
summarise(count= n())
grid.arrange(
airport %>%
ggplot(aes(x = Airport, y = count)) +
geom_bar(stat = 'identity'),
airline %>%
ggplot(aes(x = Airline, y = count)) +
geom_bar(stat = 'identity'),
gender %>%
ggplot(aes(x = Gender, y = count)) +
geom_bar(stat = 'identity'),
nationality %>%
ggplot(aes(x = Nationality, y = count)) +
geom_bar(stat = 'identity'),
trippurpose %>%
ggplot(aes(x = TripPurpose, y = count)) +
geom_bar(stat = 'identity'),
provinceresidence %>%
ggplot(aes(x = ProvinceResidence, y = count)) +
geom_bar(stat = 'identity'),
grouptravel %>%
ggplot(aes(x = GroupTravel, y = count)) +
geom_bar(stat = 'identity'),
destination %>%
ggplot(aes(x = Destination, y = count)) +
geom_bar(stat = 'identity'),
departuretime %>%
ggplot(aes(x = DepartureTime, y = count)) +
geom_bar(stat = 'identity'),
seatclass %>%
ggplot(aes(x = SeatClass, y = count)) +
geom_bar(stat = 'identity'),
modetrans %>%
ggplot(aes(x = ModeTransport, y = count)) +
geom_bar(stat = 'identity'),
occupation %>%
ggplot(aes(x = Occupation, y = count)) +
geom_bar(stat = 'identity'),
income %>%
ggplot(aes(x = Income, y = count)) +
geom_bar(stat = 'identity'),
ncol = 4
)
# Categorical Variables
grid.arrange(
acs %>%
ggplot(aes(Gender,fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(Nationality, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(TripPurpose, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(ProvinceResidence, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(GroupTravel,fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(Destination, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(DepartureTime, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(SeatClass, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(ModeTransport, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(Occupation, fill = Airport)) +
geom_bar(position = "dodge"),
acs %>%
ggplot(aes(Income, fill = Airport)) +
geom_bar(position = "dodge"),
ncol = 3
)
library(tidyverse)
library(GGally)
library(ggplot2)
library(readxl)
library(kableExtra)
library(gridExtra)
library(outliers)
library(Hmisc)
library(DMwR)
install.packages("DMwR")
library(tidyverse)
library(GGally)
library(ggplot2)
library(readxl)
library(kableExtra)
library(gridExtra)
library(outliers)
library(Hmisc)
library(DMwR)
library(here)
# Load data
## CSV file
acs <- read.csv('airport_choice_survey_modified.csv')
#traffic <- read.csv('traffic.csv')
#province <- read.csv('province.csv')
#price <- read.csv('price.csv')
## XLSX file
# acs <- read_excel("airport_choice_survey_EN_ver2.0_Capstone.xlsx", sheet = 'Data')
# traffic <- read_excel("Airport_Airline_data.xlsx", sheet = 1)
# province <- read_excel("Airport_Airline_data.xlsx", sheet = 3)
# price <- read_excel("Airport_Airline_data.xlsx", sheet = 2)
str(acs)
summary(acs)
# Remove ID column
acs <- select(acs, -1)
# Remove unwanted variables: FlightNo, FrequentFlightDestination, DepartureHr, DepartureMn, Mileage, MileageAireline
acs <- acs[ , -c(12, 14:16, 26,27) ]
# Convert data type
acs$Airport <- as.factor(acs$Airport)
acs$Airline <- as.factor(acs$Airline)
acs$Gender <- as.factor(acs$Gender)
acs$Nationality <-as.factor(acs$Nationality)
acs$TripPurpose <-as.factor(acs$TripPurpose)
acs$ProvinceResidence <-as.factor(acs$ProvinceResidence)
acs$GroupTravel <-as.factor(acs$GroupTravel)
acs$Destination <-as.factor(acs$Destination)
acs$DepartureTime <-as.factor(acs$DepartureTime)
acs$SeatClass <-as.factor(acs$SeatClass)
acs$ModeTransport <-as.factor(acs$ModeTransport)
acs$Occupation <-as.factor(acs$Occupation)
acs$Income <-as.factor(acs$Income)
knnOutput <- knnImputation(acs[, !names(acs) %in% "medv"])  # perform knn imputation.
anyNA(knnOutput)
# Impute Missing Value
# Replace numerical variables' NAs with mean
impute(acs$Age, mean)
impute(acs$TripDuration, mean)
impute(acs$FlyingCompanion, mean)
impute(acs$NoTripsLastYear, mean)
impute(acs$Airfare, mean)
impute(acs$NoTransport, mean)
impute(acs$AccessCost, mean)
impute(acs$AcessTime, mean)
# Replace categorical variables' NAs with median
impute(acs$Gender, median)
impute(acs$GroupTravel, median)
impute(acs$SeatClass, median)
impute(acs$Nationality, median)
impute(acs$TripPurpose, median)
impute(acs$ProvinceResidence, median)
impute(acs$Destination, median)
impute(acs$DepartureTime, median)
impute(acs$ModeTransport, median)
impute(acs$Occupation, median)
impute(acs$Income, median)
outlier(acs$Age)
outlier(acs$TripDuration)
outlier(acs$FlyingCompanion)
outlier(acs$NoTripsLastYear)
outlier(acs$Airfare)
outlier(acs$NoTransport)
outlier(acs$AccessCost)
outlier(acs$AccessTime)
# Outliers - numerical
outlier(acs$Age)
outlier(acs$TripDuration)
outlier(acs$FlyingCompanion)
outlier(acs$NoTripsLastYear)
outlier(acs$Airfare)
outlier(acs$NoTransport)
outlier(acs$AccessCost)
outlier(acs$AccessTime)
# Remove Outliers
acs <- acs %>%
filter(Age!=80, TripDuration!=730,FlyingCompanion!=34, NoTripsLastYear!=122,Airfare!=260,NoTransport!=4, AccessCost!=350000, AccessTime!=390)
View(acs)
